<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MP Questoria</title>

  <!-- Telegram WebApp -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- TON Connect UI -->
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app">

    <!-- ===== Главная ===== -->
    <div id="screen-home" class="screen active">
      <h1>🌌 MP Questoria</h1>
      <p id="balance">Баланс: 0 очков</p>

      <button id="linkWallet">🔗 Подключить TON-кошелёк</button>
      <button id="donate">💎 Донат</button>
    </div>

    <!-- ===== Игры ===== -->
<div class="screen" id="screen-games">
  <h2>🎮 Игры</h2>

  <div class="donate-cards">
    <!-- Простые -->
    <div class="donate-card" data-game="simple_base">
      <h4>Базовая</h4>
      <p>Простой лёгкий сценраий до 15 шагов</p>
      <span>Бесплатно</span>
    </div>

    <!-- Усложнённые -->
    <div class="donate-card" data-game="hard_base">
      <h4>Усложнённая</h4>
      <p>Больше действий в истории до 30 шагов</p>
      <span>0.5 TON</span>
    </div>

    <!-- Реалистичные -->
    <div class="donate-card" data-game="real_base">
      <h4>Реалистичная</h4>
      <p>Максимальная глубина в сценарии до 40 шагов</p>
      <span>0.5 TON</span>
    </div>
    
<!-- История Побед -->
<div class="donate-card" data-game="history">
  <h4>📜 Пройденные сюжеты</h4>
  <p>Завершённые сюжеты</p>
</div>
  
  </div>
</div>

<div id="screen-history" class="screen">
  <h2>📜 Пройденные сюжеты</h2>
  <ul id="gameHistory"></ul>
</div>
    
    <!-- ===== Replay Screen ===== -->
<div id="screen-replay" class="screen">
  <h2 id="replayTitle">📖 История сюжета</h2>
  <p id="replayMeta"></p>

  <div id="replayContent" class="replay-book"></div>

  <button onclick="showScreen('history')">⬅ Назад</button>
</div>

    <!-- ===== Рейтинг ===== -->
    <div id="screen-rating" class="screen">
      <h2>🏆 Рейтинг</h2>
      <p id="myPosition">Загрузка...</p>
      <ol id="leaderboardList"></ol>
    </div>

    <!-- ===== Друзья ===== -->
    <div id="screen-friends" class="screen">
      <h2>🤝 Друзья</h2>
      <button id="invite">🤝 Пригласить друга</button>
      <p id="refCount">Загрузка...</p>
      <ul id="refList"></ul>
    </div>

    <!-- ===== Задания ===== -->
    <div id="screen-tasks" class="screen">
      <h2>🎯 Задания</h2>
      <p id="taskInfo">Загрузка...</p>
      <button id="claimTask" style="display:none;">🎁 Забрать награду</button>
    </div>
  </div>

  <!-- ===== Нижнее меню ===== -->
  <div class="bottom-nav">
    <button data-screen="home">
      <div class="icon">🏠</div>
      <div class="label">Главная</div>
    </button>
    <button data-screen="games">
      <div class="icon">🎮</div>
      <div class="label">Игры</div>
    </button>
    <button data-screen="rating">
      <div class="icon">🏆</div>
      <div class="label">Рейтинг</div>
    </button>
    <button data-screen="friends">
      <div class="icon">🤝</div>
      <div class="label">Друзья</div>
    </button>
    <button data-screen="tasks">
      <div class="icon">🎯</div>
      <div class="label">Задания</div>
    </button>
  </div>

  <!-- ===== Модалка кошелька ===== -->
  <div id="walletModal" class="modal hidden">
    <div class="modal-content">
      <h3>💼 TON-кошелёк</h3>
      <button id="reconnectWallet">🔄 Перепривязать</button>
      <button id="disconnectWallet">❌ Отвязать</button>
      <button id="closeWalletModal">✖ Закрыть</button>
    </div>
  </div>
  
<!-- Модальное окно доната -->
<div id="donateModal" class="modal hidden">
  <div class="modal-content donate-grid">
    <h3>💎 Поддержка проекта</h3>

    <div class="donate-cards">
      <div class="donate-card" data-type="unlock_games">
        <h4>🎮 Доступ к играм</h4>
        <p>Разблокировать усложнённые и реалистичные игры</p>
        <span>0.5 TON + комиссия сети</span>
      </div>
    </div>

    <button id="closeDonateModal">✖ Закрыть</button>
  </div>
</div>
  
<!-- ===== ИГРОВОЙ ЭКРАН ===== -->
<div id="screen-game" class="screen">
  <h2 id="gameTitle">🎮 Игра</h2>

  <div id="gameStory" class="game-story">
    Загрузка истории...
  </div>

  <div id="gameChoices" class="game-choices"></div>

  <button id="exitGame" class="secondary">🚪 Выйти из игры</button>
</div>
  
<!-- ===== Resume Game Modal ===== -->
<div id="resumeModal" class="modal hidden">
  <div class="modal-content">
    <h3>🎮 Незавершённая игра</h3>
    <p id="resumeText">У тебя есть незавершённая игра</p>

    <button id="resumeContinue">▶ Продолжить</button>
    <button id="resumeRestart">🔄 Начать заново</button>
    <button id="resumeCancel">🆕 Выбрать другую игру</button>
  </div>
</div>
  
  <!-- ===== Модалка поражения ===== -->
  <div id="loseModal" class="modal hidden">
  <div class="modal-content">
  <h3>❌ Поражение</h3>
  <button id="retrySame">🔁 Переиграть</button>
  <button id="newRandom">🎲 Новая игра</button>
  </div>
</div>

<!-- ===== Модалка победы ===== -->
  <div id="winModal" class="modal hidden">
  <div class="modal-content">
    <h2>🏆 Победа!</h2>
    <p>Ты успешно прошёл этот сюжет.</p>

    <button id="winNewGame">🎮 Новая игра</button>
    <button id="winToGames">📋 К списку игр</button>
  </div>
</div>

<!-- App -->
<script src="app.js"></script>
  
</body>
</html>
